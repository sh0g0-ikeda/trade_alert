# 10. 画面仕様（UI / UX）

本章では、モバイルアプリ（iOS / Android 共通）の画面構成と、
それぞれの画面における **表示項目・ユーザー操作・画面遷移** を定義する。

ナビゲーション構成は以下の３つをベースとする：

* 認証フロー（未ログイン時）
* メインタブ（ログイン後）
* モーダル・サブ画面（追加設定・詳細）

---

## 10.1 画面一覧

### 認証系

1. ログイン画面（Login）
2. 新規登録画面（SignUp）

### メインタブ

3. ホームタブ（銘柄一覧）
4. 通知履歴タブ
5. 設定タブ

### サブ画面 / モーダル

6. 銘柄追加フロー

   * 資産クラス選択画面
   * 銘柄検索画面
   * 基準価格設定画面
7. 銘柄詳細画面（アラート設定）
8. スクショインポートフロー

   * スクショアップロード画面
   * 解析結果確認画面
9. プラン詳細・アップグレード画面

---

## 10.2 ナビゲーション構成

### 10.2.1 未ログイン時

* 初期表示：ログイン画面
* 「アカウントを持っていない」→ 新規登録画面へ
* ログイン or サインアップ完了 → メインタブへ遷移

### 10.2.2 ログイン後

* 下部タブナビゲーション：

  * Tab1：ホーム（銘柄一覧）
  * Tab2：通知履歴
  * Tab3：設定

* 画面内からの遷移：

  * ホーム → 銘柄追加フロー
  * ホーム → 銘柄詳細
  * 設定 → プラン詳細
  * 設定 / ホーム → スクショインポート

---

## 10.3 各画面仕様

---

### 10.3.1 ログイン画面

**目的**

* 既存ユーザーのログイン

**要素**

* アプリロゴ or タイトル
* テキスト入力：

  * メールアドレス
  * パスワード
* ボタン：

  * 「ログイン」
  * 「アカウントを作成する」（SignUp画面へ）
* エラー表示エリア：

  * 認証失敗時メッセージ表示

**挙動**

* 「ログイン」押下

  * フォームバリデーション（空・形式）
  * 成功 → `access_token` 保存 → メインタブへ
  * 失敗 → メッセージ「メールアドレスまたはパスワードが正しくありません」

---

### 10.3.2 新規登録画面（SignUp）

**目的**

* メール＋パスワードで新規ユーザー登録

**要素**

* 入力：

  * メールアドレス
  * パスワード
  * パスワード確認
* チェックボックス：

  * 利用規約・プライバシーポリシーへの同意
* ボタン：

  * 「登録して始める」
  * 「ログイン画面へ戻る」

**挙動**

* 「登録して始める」押下：

  * バリデーション（メール形式・パスワード8文字以上・一致確認）
  * 成功 → 自動ログイン → メインタブへ
  * 失敗 → エラー表示（既に登録済み・弱いパスワード等）

---

## 10.4 ホームタブ（銘柄一覧）

**目的**

* ユーザーが登録した銘柄の一覧を表示し、
  「今どうなっているか」と「アラート設定状況」をひと目で把握できるようにする。

**要素**

* ヘッダー：

  * タイトル：「監視中の銘柄」
  * 右上：

    * 「＋」ボタン（銘柄追加）
* リスト表示（1行＝1銘柄）：

  * 左：

    * 資産クラスアイコン（株 / 仮想通貨 / FX など）
  * 中央：

    * 銘柄名（例：Apple Inc.）
    * ティッカー（例：AAPL）
  * 右：

    * 現在価格（例：142.20 USD）
    * 基準値との差分（例：-5.2%：色で表現）

**動作**

* リスト行タップ → 「銘柄詳細画面」へ
* 「＋」ボタン → 「資産クラス選択画面」へ
* 無料プランで6銘柄以上ある場合：

  * 6件を超えた銘柄は「アラート対象外」のバッジ表示（仕様次第）

**空状態**

* 銘柄が1件もない場合：

  * 「まだ監視中の銘柄はありません」
  * 「＋ボタンから銘柄を追加するか、スクショインポートを試してください」
  * スクショインポートへのショートカットボタンを表示してもよい

---

## 10.5 銘柄追加フロー

### 10.5.1 資産クラス選択画面

**目的**

* 追加する銘柄の大分類を選ぶ

**要素**

* タイトル：「資産クラスを選択」
* 選択肢（ボタン or カード）：

  * 株式
  * 仮想通貨
  * FX
  * 金・原油
  * 指数

**挙動**

* いずれかをタップ → 銘柄検索画面へ遷移（選択したクラスを引き継ぐ）

---

### 10.5.2 銘柄検索画面

**目的**

* ティッカー or 名称から、監視対象に追加したい銘柄を選ぶ。

**要素**

* 検索バー：

  * プレースホルダ：「ティッカーまたは名称で検索」
* 検索結果リスト：

  * 銘柄名
  * ティッカー
  * 取引所（株の場合）

**挙動**

* 入力 → 検索ボタン押下 → `/assets/search` 呼び出し
* 結果タップ → 基準価格設定画面へ

**空 / エラー**

* 候補が0件：

  * 「この資産クラスでは該当する銘柄が見つかりませんでした」

---

### 10.5.3 基準価格設定画面

**目的**

* その銘柄に対して、基準価格（買値など）を設定する。

**要素**

* 銘柄情報：

  * 銘柄名
  * ティッカー
* 入力：

  * 基準価格（初期値：現在価格）
* 表示：

  * 現在価格（参考用）
* ボタン：

  * 「この価格を基準にする」
  * 「キャンセル」

**挙動**

* 無料プラン：

  * アラート条件はここでは表示のみ（「±5%で通知」）
* 有料プラン：

  * 任意で「上昇 / 下落のしきい値」を一緒に設定できる簡易UIがあってもよい

---

## 10.6 銘柄詳細画面（アラート設定）

**目的**

* 選んだ銘柄について、現在の状況・アラート条件・通知履歴を確認・変更する。

**要素**

* ヘッダー：

  * 銘柄名
  * ティッカー
* セクション 1：現在の状態

  * 現在価格
  * 基準価格
  * 基準値との差分（%）
  * 最後に通知された日時
* セクション 2：アラート設定

  * 無料プラン：

    * テキスト：
      「基準価格または前回通知価格から ±5% を超えた場合に通知します」
    * 編集不可（グレーアウト表示）
    * 「有料プランでしきい値を自由に設定できます」リンク
  * 有料プラン：

    * 数値入力 or スライダー：

      * 「上昇：＋X%で通知」
      * 「下落：−Y%で通知」
* セクション 3：操作

  * 「この銘柄を削除」（監視から外す）

**挙動**

* 有料ユーザーのみ、しきい値入力欄が編集可能
* 保存ボタンで `/user/assets/{id}` に PUT

---

## 10.7 通知履歴タブ

**目的**

* 最近の通知を一覧で確認し、「なぜ今この状況なのか」を振り返れるようにする。

**要素**

* ヘッダー：「通知履歴」
* リスト（1行ごと）

  * 日時（例：2025/12/02 14:00）
  * 銘柄ティッカー（例：AAPL）
  * 変動方向・変動率（例：-5.3%）
  * アイコン（資産クラス）

**挙動**

* 行タップ → 対象銘柄の「銘柄詳細画面」へ遷移
* 「もっと読み込む」ボタン or スクロール末尾で自動追加読み込み

  * `/notifications/history` に `cursor` 付きで再リクエスト

**空状態**

* 「まだ通知はありません。
  　基準価格としきい値を設定すると、条件を満たしたときに通知されます。」

---

## 10.8 設定タブ

**目的**

* プラン・スクショインポート・アカウント情報・ログアウトなど、
  全体的な設定・メタ情報を扱う。

**要素**

* セクション 1：アカウント

  * メールアドレス（表示のみ）
  * 「ログアウト」ボタン
* セクション 2：プラン

  * 現在のプラン表示（例：「無料プラン」/「Proプラン（有料）」）
  * 制限概要：

    * 「登録可能銘柄：6件まで」
    * 「スクショインポート：月2回まで」
  * 「プランの詳細を見る / アップグレード」ボタン → プラン画面へ
* セクション 3：スクショインポート

  * 「スクショから銘柄を一括登録」ボタン → スクショフローへ
  * 今月の利用状況（例：「1 / 2 回」）
* セクション 4：その他

  * 利用規約
  * プライバシーポリシー
  * アプリバージョン表示

---

## 10.9 スクショインポートフロー

### 10.9.1 スクショアップロード画面

**目的**

* 証券アプリの保有銘柄一覧画面のスクショを選び、DeepSeekに送る。

**要素**

* 説明テキスト：

  * 「証券アプリ等の“保有銘柄一覧”画面のスクリーンショットをアップロードしてください」
  * 「画像は解析後すぐに削除されます」
* ボタン：

  * 「写真から選ぶ」（ギャラリー）
  * （任意）「カメラで撮影」

**挙動**

* 画像選択 → `/screenshot/import` に送信
* ローディング表示
* 成功 → 解析結果確認画面へ
* 失敗 → 「解析に失敗しました。時間をあけて再度お試しください」

  * 戻るボタン

---

### 10.9.2 解析結果確認画面

**目的**

* DeepSeekが読み取った銘柄候補をユーザーに提示し、
  どれを登録するか・基準価格をどうするかを決める。

**要素**

* 説明：

  * 「スクショから以下の銘柄を読み取りました。登録する銘柄と基準価格を確認してください。」
* リスト（1行＝1候補）：

  * チェックボックス：登録するかどうか
  * 銘柄名＋ティッカー
  * 取得した価格（編集可能な入力欄：`base_price`）
  * 通貨表示（USD / JPY 等）
* 下部ボタン：

  * 「選択した銘柄を登録」
  * 「キャンセル」

**挙動**

* チェックがついているものだけ `/screenshot/import/confirm` に送信
* 無料プランで回数・銘柄上限を超えた場合：

  * モーダルで「無料プランの上限に達しています。有料プランで制限を解除できます」と表示
  * 有料プラン画面へのリンク

---

## 10.10 プラン詳細・アップグレード画面

**目的**

* 無料/有料の違いを明確に提示し、有料プランへのアップグレード導線にする。

**要素**

* 現在のプラン表示

* 無料 vs 有料の比較表（主に）

  * 銘柄数上限（6 vs 実質無制限）
  * 監視時間（8:00〜24:00 vs 24h）
  * チェック間隔（4h vs 1〜2h）
  * アラートしきい値（固定±5% vs 自由設定）
  * スクショインポート回数　など

* ボタン：

  * 「有料プランにアップグレード」

    * → ストア決済フロー起動
  * 有料ユーザーの場合：

    * 「サブスクリプションを管理（ストアを開く）」ボタン

**挙動**

* アップグレード成功後：

  * `/subscriptions/verify` 成功 → plan_type = paid
  * 表示を即座に更新
  * ホーム・銘柄詳細のUIも有料仕様に切り替え

---

## 10.11 UX上のルール

### 10.11.1 エラーメッセージ

* なるべく「技術用語」を避けて、ユーザー視点で説明する

  * 例：「サーバーエラーが発生しました」より
    　  「通信に失敗しました。ネットワーク状況を確認して、もう一度お試しください。」

### 10.11.2 ローディング

* API通信中は必ずインジケータ表示
* スクショ解析は数秒以上かかる可能性があるため、進行状況や説明テキストを表示する

### 10.11.3 通知の期待値

* プラン画面・設定画面などで
  「アラートは4時間ごと/2時間ごとにチェックされるバッチ処理であり、リアルタイムではない」
  ことを軽く明示（過度な期待を防ぐ）

